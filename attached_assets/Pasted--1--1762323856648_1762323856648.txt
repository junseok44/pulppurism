## 1. 서비스 개요

- **목표:** 주민들의 의견을 체계적으로 수집, 공론화하고, 클러스터링을 통해 실제 '안건'으로 발전시켜 공식적인 제안 및 답변으로 연결하는 반응형 웹 플랫폼.
- 핵심 워크플로우: (주민) 의견 등록 → (시스템/관리자) 유사 의견 '클러스터'화 → (관리자) 클러스터를 기반으로 '안건'을 생성하고 참고 자료(링크, 파일, 타지역 정책사례)를 추가하여 통합 제안 자료로 구성 → (주민) 안건 투표 및 의견 개진 → (관리자) 안건 진행상황 공유 및 공식 답변 등록

## 2. 핵심 개념 정의

- **의견:** 주민이 등록하는 개별 아이디어, 제안, 민원. (댓글 형식)
- **클러스터:** 유사한 주제의 '의견'들이 묶인 그룹. 시스템이 자동 제안하거나 관리자가 수동 생성.
    - **클러스터링 시점 (When):**
        1. **실시간 분석:** 신규 주민 의견이 등록될 때, 시스템은 기존 클러스터와의 유사도를 즉시 검토하여 자동 편입을 시도.
            
            ```jsx
            {
              "new_opinion": {
                "id": 123,
                "text": "..."
              },
              "existing_clusters": [
                { "cluster_id": "C-001", "title": "공원 내 야간 소음 불만" },
                { "cluster_id": "C-002", "title": "스쿨존 교통 안전 개선 요청" }
              ],
              "instructions": {
                "task": "Analyze the `new_opinion` and determine the single BEST matching `existing_cluster`.",
                "output_format": {
                  "cluster_id": "Return the ID of the best matching cluster (e.g., 'C-002').",
                  "reason": "Briefly explain why this opinion's core topic matches the cluster's title."
                },
                "no_match_rule": "If the opinion's core topic does not *directly* match any cluster title, return `cluster_id: 'UNCLASSIFIED'`."
              }
            }
            ```
            
        2. **주기적 분석 (Batch):** 1일 1회 (또는 관리자가 설정한 주기) 시스템이 전체 미분류 의견들을 재검토하여, 새로운 클러스터 생성 기회를 탐색하고 관리자에게 제안.
            
            ```jsx
            {
              "unclassified_opinions": [ ... ],
              "instructions": {
                "task": "Group the opinions into clusters based on *specific, actionable topics*.",
                "cluster_rules": {
                  "min_opinions_per_cluster": 2,
                  "title_format": "Summarize the core *problem* or *proposal* in 15 chars or less."
                },
                "examples": {
                  "good_cluster": "예: 'A초등학교 앞 과속방지턱 설치 요청'",
                  "bad_cluster": "예: '교통 문제' (너무 광범위함)"
                },
                "output_format": { ... }
              }
            }
            ```
            
    - **클러스터링 기준 (How):** (아래 기준 중 하나 이상 충족 시 자동 제안)
        1. **유사 의견 누적 (Similarity-based):** 자연어 처리(NLP) 등을 통해 의미/키워드가 유사하다고 판단되는 의견이 일정 수(예: 5개) 이상 누적될 경우, 신규 클러스터로 자동 제안.
        2. **높은 관심도 (Engagement-based):** 특정 단일 의견이 많은 수의 '좋아요' 또는 '답글'(예: 좋아요 10개 또는 답글 5개)을 받아 주민 관심도가 높다고 판단될 경우, 해당 의견을 중심으로 하는 클러스터가 자동 제안.
- **안건:** '클러스터'를 기반으로 관리자가 공식화한 공론화 주제. 투표, 타임라인, 참고 자료, 공식 답변이 관리됨.

## 3. 사용자 역할 및 권한

1. **일반 유저 (주민):**
    - 플랫폼에 가입한 사용자.
    - 의견/답글 작성, 좋아요, 안건 조회, 투표, 즐겨찾기, 알림 수신.
2. **관리자 (운영자):**
    - 플랫폼의 전체 운영 책임자.
    - 모든 의견, 안건, 사용자 데이터에 접근 및 관리 권한을 가짐.

## 4. 일반 유저 (주민) 서비스

### 4.1. 안건 탭 (메인)

- **안건 리스트 (기본 화면):**
    - 안건 검색 아이콘
        - 눌렀을때 검색 페이지로 이동. 검색어 입력시 제목 기준으로 관련 있는 안건 보여줌.
    - 카테고리(돌봄, 의료, 환경, 교육, 생활, 교통, 경제, 문화, 정치, 행정, 복지) 버튼 → 눌렀을때 필터링.
        - 카테고리별 안건 목록을 카드/리스트 형태로 노출 및 페이지네이션 (선택 안되었을때는 전체 안건을 페이지네이션)
            - 안건 제목
            - 카테고리
            - 안건 댓글 수 (아이콘 + 숫자)
                - 안건 댓글은 안건 생성시 클러스터와 연결하는데, 해당 클러스터에 속한 주민 의견을 모두 댓글로 간주
            - 안건 상태
                - 안건의 현재 상태 표시(예: 의견 접수 → 안건 작성 → 주민 투표 → 검토 중 → 답변 및 결과)
            - 즐겨찾기 수 (아이콘 + 숫자)
    
- **안건 조회 화면:** 안건 클릭 시 이동.
    - **공통 영역:** 안건 제목, 카테고리, 즐겨찾기 버튼, 안건 관련 사진 (optional)
    - 개요 탭:
        - 안건 소개: (관리자가 작성한) 안건의 배경, 목적, 상세 설명.
        - 투표: '찬성', '중립', '반대' (1인 1표, 수정 가능). 투표 참여 시 즉시 결과(%) 노출. (상시 투표)
        - 진행상황 타임라인: 안건의 현재 상태 표시(예: 의견 접수 → 안건 작성 → 주민 투표 → 검토 중 → 답변 및 결과) 및 이전 상태의 경우 완료된 상태 및 날짜를 표시,
        - 답변 및 결과: (관리자가 등록한) 안건 제안에 대한 공식 답변 및 처리 결과.
    - 주민의견 보기 탭:
        - 전체적인 기능은 주민의견탭과 유사.
        - 이 안건과 연결된 '클러스터'의 원본 주민 의견들 목록이 리스트로
            - 리스트 아이템은 주민의견탭의 주민 의견 리스트 아이템과 유사.
            - 해당 리스트 아이템 눌렀을때 주민 의견 상세 페이지로 이동.
        - 해당 안건에 대한 새로운 '연관 주민 의견' 추가 기능. (맨 밑에 input이 있어서 댓글처럼 추가 가능)
        - 기존 의견에 대한 답글 및 좋아요 기능.
    - 참고자료 탭:
        - (관리자가 등록한) 관련 외부 페이지 링크 목록 (클릭 시 새 탭, 미리보기 형태).
        - (관리자가 등록한) 관련 첨부 파일 목록 (다운로드).

### 4.2. 주민의견 탭

- **의견 리스트:** 모든 주민 의견을 최신순으로 보여줌. (무한 스크롤)
    - 주민 의견 리스트 아이템 구성
        - 썸네일
        - 주민 이름
        - 의견 내용 (100자 이상일때는 줄이기…)
        - 좋아요 수 (내가 좋아요 했을때 하트가 채워짐), 댓글 수
        - 더보기 버튼 (작성자일때 삭제, 수정)
- **의견 등록:** '의견 달기' 플로팅 버튼 클릭 시, 의견 등록 페이지로 이동
    - 의견 등록 페이지에서는 두가지 버튼이 있음.
        - 민원 혹은 제안 입력하기
        - 음성으로 입력하기
            - 이 버튼을 누르면 음성 입력 화면으로 넘어감.
            - 다 들으면 해당 input이 맞는지 확인, 다시 수정가능.
                - 최종적으로 게시 누르면 주민 의견이 추가됨.
- **상호작용:** 기존 주민 의견에 대한 답글 작성 및 좋아요.
    - 안건 리스트에서 특정 주민 의견 리스트 아이템을 클릭하면 의견 상세 조회 페이지로 들어감
    - 거기서 해당 의견과 그 밑에 달린 댓글들을 조회할 수 있음 (기본 depth는 1)

### 4.3. 마이페이지 탭

- **내 활동 관리:**
    - 내가 쓴 주민 의견 (원본)
    - 내가 단 답글
    - 좋아요한 의견
    - **내 의견이 포함된 안건**
    - 내가 즐겨찾기한 안건
- **알림 내역:**
    - 내 의견에 답글이 달렸을 때.
    - 내 의견이 '안건'에 포함되었을 때.
    - 즐겨찾기한 안건의 '진행상황'이 업데이트되었을 때.
    - 즐겨찾기한 안건에 '공식 답변'이 등록되었을 때.
- **계정 설정:**
    - 프로필 수정 (닉네임, 프로필 사진).
    - 계정 정보 (아이디 확인, 비밀번호 변경).
    - 알림 설정 (항목별 On/Off).
    - 로그아웃 / 회원 탈퇴.

## 5. 관리자 페이지

### 5.1. 통합 대시보드 (메인)

- 핵심 통계
    - (오늘/주간) 신규 의견 수, 활발하게 논의 중인 안건, 최근 투표가 급증한 안건, 신규 가입자 수.
- 긴급 처리 필요 항목
    - 신고 접수된 의견/답글
- 최근 활동 피드
    - 최근 생성된 안건, 최근 등록된 공식 답변 등 주요 활동 내역.

### 5.2. 주민 의견 관리

- **의견 클러스터 관리 (워크벤치):**
    - 시스템이 제안하는 클러스터 목록 조회.
    - 관리자 수동 클러스터 생성, 병합, 분리, 이름 변경.
    - 클러스터 상태 관리 (예: 검토 중, 안건 생성됨, 보류).
- **전체 의견 관리:**
    - 신고 관리: 신고된 의견/답글을 모아보고 **'숨김/비공개'** 또는 '정상' 처리.
    - 모든 의견을 검색하고 강제 숨김/삭제 처리.

### 5.3. 안건 관리

- **전체 안건 관리:**
    - 플랫폼의 **'모든 안건'** 목록을 조회.
    - 목록에서 바로 수정, (필요시) 숨김/삭제 처리.
- **안건 정보 업데이트:**
    - 일반 '안건 조회' 페이지에서 관리자에게만 보이는 $$수정$$
        
        버튼을 통해 상세 내용(개요, 타임라인, 공식 답변)을 직접 업데이트.
        
- **참고 자료 등록:**
    - 안건 수정 기능의 일부로, $$참고자료$$
        
        탭에 **관련 외부 페이지 링크를 추가**하거나, **관련 파일(PDF, HWP, 이미지, 타지역 사례 요약 등)을 업로드**하여 주민들에게 공개.
        
- **새 안건 생성:** '주민 의견 관리'의 클러스터를 선택하여 '안건'을 생성 (제목, 내용, 카테고리, 클러스터 연결).
- **안건 카테고리 관리:** 플랫폼에서 사용할 카테고리(돌봄, 의료 등)를 생성, 수정, 삭제, 순서 변경.

### 5.4. 사용자 관리

- **전체 사용자 관리:**
    - 플랫폼에 가입된 전체 사용자 목록 조회 및 닉네임/이메일 검색.
- **사용자 제재:**
    - 문제 사용자(신고 누적 등)의 계정 '일시 정지' 또는 '영구 정지' 처리.
- **관리자 관리:**
    - 현재 관리자가 본인을 도와줄 다른 관리자를 초대하거나 권한을 삭제.